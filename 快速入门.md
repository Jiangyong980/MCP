# 快速入门：5 分钟上手禅道 MCP

> 这是针对开发者的快速入门指南。如果遇到问题，请参考完整的《禅道MCP使用手册.md》

---

## 1️⃣ 前置检查

- ✅ 安装了 Python 3.11+
- ✅ 有禅道账号和密码
- ✅ 禅道服务器可访问

---

## 2️⃣ 安装依赖（2 分钟）

### 方式 A：使用 UV（推荐）

```bash
# Windows PowerShell（以管理员身份运行）
irm https://astral.sh/uv/install.ps1 | iex

# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# 进入项目目录并同步
cd C:\development\Projects\agent
uv sync
```

### 方式 B：使用 pip

```bash
python -m venv .venv
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # macOS/Linux
pip install -r requirements.txt
```

---

## 3️⃣ 配置禅道（1 分钟）

创建 `.env` 文件：

```env
ZENTAO_BASE_URL=http://172.16.0.193:8088
ZENTAO_USERNAME=你的用户名
ZENTAO_PASSWORD=你的密码
```

---

## 4️⃣ 测试运行（1 分钟）

```bash
uv run python run_zentao_mcp.py
```

看到以下输出表示成功：

```
INFO: Zentao MCP Server initialized
INFO: Ready to accept connections
```

按 `Ctrl+C` 停止。

---

## 5️⃣ 集成到 AI 工具（1 分钟）

### 查找 Python 路径

```bash
uv python find
# 输出类似：C:\Users\john\Projects\agent\.venv\Scripts\python.exe
```

### Claude Desktop 配置

编辑：`%APPDATA%\Claude\settings.json`

```json
{
  "mcpServers": {
    "zentao": {
      "command": "C:\\Users\\john\\Projects\\agent\\.venv\\Scripts\\python.exe",
      "args": ["C:\\Users\\john\\Projects\\agent\\run_zentao_mcp.py"],
      "env": {
        "ZENTAO_BASE_URL": "http://172.16.0.193:8088",
        "ZENTAO_USERNAME": "你的用户名",
        "ZENTAO_PASSWORD": "你的密码"
      }
    }
  }
}
```

**⚠️ 修改完后重启 Claude Desktop**

### Kimi Code CLI 配置

编辑：`~/.kimi/mcp.json`

```json
{
  "mcpServers": {
    "zentao": {
      "command": "/Users/john/Projects/agent/.venv/bin/python",
      "args": ["/Users/john/Projects/agent/run_zentao_mcp.py"],
      "env": {
        "ZENTAO_BASE_URL": "http://172.16.0.193:8088",
        "ZENTAO_USERNAME": "你的用户名",
        "ZENTAO_PASSWORD": "你的密码"
      }
    }
  }
}
```

验证：

```bash
kimi mcp test zentao
```

---

## 🎉 现在可以用了！

在 Claude 或 Kimi 中问：

> "禅道中有哪些产品？"
>
> "查看迭代10的所有任务"
>
> "在迭代11中创建一个开发任务：实现登录功能，指派给张三，预计2天完成"

---

## 常见问题

### Q: 连接失败，怎么办？

**检查清单**：

```bash
# 1. 环境变量是否正确
python -c "from dotenv import load_dotenv; load_dotenv(); import os; print(os.getenv('ZENTAO_BASE_URL'))"

# 2. 禅道服务是否可访问
curl http://172.16.0.193:8088

# 3. 直接运行 MCP 看错误日志
uv run python run_zentao_mcp.py
```

### Q: Python 路径怎么查？

```bash
uv python find
# 或
python -c "import sys; print(sys.executable)"
```

### Q: 密码包含特殊字符怎么办？

在 `.env` 中用引号括起来：

```env
ZENTAO_PASSWORD="你的@密码#123"
```

### Q: 支持哪些操作？

✅ 支持（已实现）：
- 查询和创建：需求、任务、Bug、迭代、项目、产品
- 更新和删除：需求、任务、Bug、迭代、项目、产品
- 查询用户信息

❌ 暂不支持：
- 测试用例、测试任务
- 用户反馈、工单
- 版本和发布

详见 `DEVELOPER_FEATURES.md`

---

## 需要帮助？

- 📖 完整文档：`禅道MCP使用手册.md`
- 🎯 功能分类：`DEVELOPER_FEATURES.md`
- 🐛 遇到问题：检查日志，参考故障排除部分

---

**版本**：1.0
**最后更新**：2026-01-30
